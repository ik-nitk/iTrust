{% extends "base.html" %}

{% block scripts %}
    {{ super() }}
    <script>
        $(document).ready(function () {
            function load_data(query) {
                $.ajax({
                    url: "/members/search",
                    method: "POST",
                    data: { query: query },
                    success: function (data) {
                        $("#result").html(data);
                        $("#result").append(data.htmlresponse);
                    },
                });
            }
            const debounce = (func, wait, immediate) => {
                var timeout;

                return function executedFunction() {
                    var context = this;
                    var args = arguments;

                    var later = function () {
                        timeout = null;
                        if (!immediate) func.apply(context, args);
                    };

                    var callNow = immediate && !timeout;

                    clearTimeout(timeout);

                    timeout = setTimeout(later, wait);

                    if (callNow) func.apply(context, args);
                };
            };
            $("#search_text").keyup(
                debounce(function () {
                    var search = $(this).val();
                    if (search.length > 2) {
                        load_data(search);
                    }
                }, 1000)
            );
        });
    </script>
{% endblock %}

{% block content %}
<div class="container-fluid" style="width: 40rem">
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Search</span>
                <input
                    type="text"
                    name="search_text"
                    id="search_text"
                    class="form-control"
                    placeholder="Search By Name Or GovtID"
                />
            </div>
            <div id="result"></div>
        </div>
</div>
{% endblock %}
